name: linux-firmware
variant: scratch
shell: /toolchain/bin/bash
dependencies:
    - image: '{{ .TOOLS_IMAGE }}'
steps:
    - sources:
          - url: https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/snapshot/linux-firmware-20200519.tar.gz
            destination: linux-firmware.tar.gz
            sha256: b33b727f0ae299c65cb7ddf1cc3ab3ebe50085bd50694fd3af7fd7f07303476c
            sha512: 9724cf3d1aea73f264d53564ef160a62e90bb35766f3300bbbeaf7c7c6a356ef50c7d17bfa01197e8e991ff72b1aeef002bb78f5dc78243b2792cafbf1139dff
      prepare:
          - |
              mkdir -p lib/firmware
              tar -xzf linux-firmware.tar.gz --strip-components=1 -C lib/firmware
      install:
          - |
              mkdir /rootfs
              cp -R lib /rootfs
finalize:
    - from: /rootfs
      to: /
