name: xfsprogs
variant: scratch
shell: /toolchain/bin/bash
dependencies:
  - stage: base
  - stage: util-linux
steps:
  - sources:
      - url: https://www.kernel.org/pub/linux/utils/fs/xfs/xfsprogs/xfsprogs-5.5.0.tar.xz
        destination: xfsprogs.tar.xz
        sha256: cfbb0b136799c48cb79435facd0969c5a60a587a458e2d16f9752771027efbec
        sha512: 1169765e9a003f9618f020eb190dc0a692e7017cf1ec2a9329a8db0f07ef6a48cb250fc326fb9168714259c8d5f2195cc6fd41e01bbbdc9a5857e53f145b6815
    prepare:
      - |
        tar -xJf xfsprogs.tar.xz --strip-components=1

        ./configure \
        --prefix=/usr \
        --enable-gettext=no
    build:
      - |
        make -j $(nproc) DEBUG=-DNDEBUG
    install:
      - |
        make install DESTDIR=/rootfs
finalize:
  - from: /rootfs
    to: /
